!function(tactic){tactic.utils=tactic.utilities||tactic.utils||{},tactic.builder={props:{},layers:{},fonts:{}};var container=tactic.container,utils=tactic.utils;utils.Timeline=function(t){var r=this;this.date=new Date,this.timestamp=this.date.getTime(),this.speed=utils.isTypeOf(utils.isNumber,window.TACTIC_TIMELINE_SPEED_MULTPLIER,utils.isTypeOf(utils.isNumber,t,1)),this.rate=10,this.step=Math.round((this.rate<0?0:this.rate)*(this.speed<0?0:this.speed)),this.schedule={},this.setTimeout=function(t,e){if(!t||isNaN(e))return null;var s=r.timestamp+Math.round(e/r.step)*r.step+r.step;r.schedule[s]||(r.schedule[s]=[]);var i={id:NaN,timestamp:s,callback:t};return i.id=r.schedule[s].push(i),i},this.clearTimeout=function(t){t&&(t.callback=null)},this.interval=setInterval(function(){r.schedule[r.timestamp]&&utils.each(r.schedule[r.timestamp],function(t){t&&t.callback&&(t.callback.call(),r.clearTimeout(t))}),r.timestamp+=r.step},this.rate)},utils.arrayIndex=function(t,e){if(!utils.isArray(t))return-1;if(!utils.isString(e)&&!utils.isBoolean(e))return-1;if(Array.prototype.indexOf)return t.indexOf(e);for(var s=t.length;s--;)if(t[s]===e)return s;return-1},utils.getElementsByKey=function(t,e){return utils.isElement(t)?t.querySelectorAll("[data-key="+e+"]"):[]},utils.isTypeOf=function(t,e,s){return!utils.isFunction(t)||utils.isUndefined(e)?!utils.isUndefined(s)&&s:utils.isUndefined(s)?t(e):t(e)?e:s},utils.addEventSimple=function(t,e,s){return t&&e&&s?(t.addEventListener?t.addEventListener(e,s,!1):t.attachEvent&&t.attachEvent("on"+e,s),{target:t,type:e,callback:s}):null},utils.removeEventSimple=function(t,e,s){return t&&e&&s?(t.removeEventListener?t.removeEventListener(e,s,!1):t.detachEvent&&t.detachEvent("on"+e,s),null):{target:t,type:e,callback:s}},utils.getStyle=function(t,e,s){try{if(utils.isElement(t))return t.currentStyle?t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,"")[e]:t.style[e]}catch(t){}return s},utils.getAssetSource=function(t,e,s,i,r){var a={};if(t){i=isNaN(i)?0:i,r=isNaN(r)?1920:r,t.sort(function(t,e){return t.width<e.width?1:t.width>e.width?-1:0}),a=t[0];for(var n=0;n<t.length&&!(t[n].width<=r&&t[n].height<=r&&(e>=t[n].width||s>=t[n].height||a.width<=i||a.height<=i));n++)a=t[n]}return a},utils.getAssetUrl=function(t,e){utils.isString(e)||(e="url");var s=utils.isObject(t)?utils.isString(t[e])?t[e]:"":utils.isString(t)?t:"";return""===s||s&&-1!==s.indexOf("data:image")||-1===s.indexOf("http")&&"//"!==s.slice(0,2)&&(s=tactic.url.sanitize(tactic.url.package&&0<tactic.url.package.length?tactic.url.package+"/"+s:s)),s},utils.selectProperty=function(t,e){try{return t.filter(function(t){return t[0]<=e}).sort(function(t,e){return t[0]<e[0]?1:t[0]>e[0]?-1:0})[0][1]}catch(t){return null}},utils.watchFont=function(t,e,s,i,r){tactic.builder.fonts[t]||(tactic.builder.fonts[t]={key:t,family:e||"inherit",target:document.createElement("span"),wrapper:document.createElement("span"),holder:utils.isElement(i)?i:document.body,time:(new Date).getTime(),timeout:utils.isNumber(r)?r:1e3,width:void 0,height:void 0,initiated:!1,success:void 0,callbacks:[]});function a(t){n.success=t;try{n.holder.removeChild(n.wrapper)}catch(t){}for(var e in n.callbacks)utils.isFunction(n.callbacks[e])&&(n.callbacks[e](n.key,n.success),n.callbacks[e]=null)}var n=tactic.builder.fonts[t],l=function(){(new Date).getTime()-n.time>n.timeout?a(!1):n.width!==n.target.offsetWidth||n.height!==n.target.offsetHeight?a(!0):setTimeout(function(){l()},10)};try{if(n.callbacks.push(s),n.initiated)utils.isUndefined(n.success)||a(n.success);else{n.initiated=!0;var o=n.wrapper.style,u=n.target.style;o.position="absolute",o.overflow="hidden",o.visibility="hidden",u.fontFamily="Times New Roman",u.width="auto",u.height="auto",u.display="block",u.fontSize="48px",u.lineHeight="normal",u.color="transparent",u.visibility="hidden",u.fontDisplay="swap",n.target.innerHTML="QW@HhsXJ1",n.wrapper.appendChild(n.target),n.holder.appendChild(n.wrapper),setTimeout(function(){n.width=n.target.offsetWidth,n.height=n.target.offsetHeight,u.fontFamily=n.family,l()},0)}}catch(t){a(!1)}},utils.hasClass=function(t,e){return!utils.isUndefined(t)&&"className"in t&&new RegExp("(\\s|^)"+utils.escapeRegExpString(e)+"(\\s|$)").test(t.className)},utils.addClass=function(t,e){return utils.isElement(t)&&utils.isString(e)&&!utils.hasClass(t,e)&&(t.className+=" "+e,t.className=t.className.split("  ").join(" ")),e},utils.addClasses=function(t,e){var s=[];if(utils.isElement(t)&&utils.isArray(e))for(var i in e)s.push(utils.addClass(t,e[i]));return s},utils.removeClass=function(t,e){return utils.isElement(t)&&utils.isString(e)&&utils.hasClass(t,e)&&(t.className=t.className.split("  ").join(" ").replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," ")),utils.isString(e)?e:""},utils.removeClasses=function(t,e){var s=[];if(utils.isElement(t)&&utils.isArray(e))for(var i=0;i<e.length;i++)s.push(utils.removeClass(t,e[i]));return s},utils.getStyle=function(t,e,s){try{if(utils.isElement(t))return t.currentStyle?t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,"")[e]:t.style[e]}catch(t){}return s},utils.createCssRule=function(t,e){if(document.styleSheets&&0!==document.getElementsByTagName("head").length&&!utils.isEmptyString(t)&&"."!==t&&!utils.isEmptyString(e)){var s,i,r,a;if(t=1<(t=t.split(" !.").join(".")).split("!").length?t.split("!")[1]:t,e=e.split("'").join('"'),0<document.styleSheets.length)for(a=0,r=document.styleSheets.length;a<r;a++)if(!document.styleSheets[a].disabled){var n=document.styleSheets[a].media;if("string"===(i=typeof n)?""!==n&&-1===n.indexOf("screen")||(s=document.styleSheets[a]):"object"===i&&-1!==n.mediaText.indexOf("screen")&&(s=document.styleSheets[a]),void 0!==s)break}if(void 0===s){var l=document.createElement("style");for(l.type="text/css",document.getElementsByTagName("head")[0].appendChild(l),a=0;a<document.styleSheets.length;a++)document.styleSheets[a].disabled||(s=document.styleSheets[a]);i=typeof s.media}if("string"===i){for(a=0,r=s.rules.length;a<r;a++)if(s.rules[a].selectorText&&s.rules[a].selectorText.toLowerCase()===t.toLowerCase())return s.rules[a].style.cssText=e,{sheet:s,rule:a};return{sheet:s,rule:s.addRule(t,e)}}if("object"!==i)return null;var o=s.cssRules?s.cssRules.length:0;for(a=0;a<o;a++)if(s.cssRules[a].selectorText&&s.cssRules[a].selectorText.toLowerCase()===t.toLowerCase())return s.cssRules[a].style.cssText=e,{sheet:s,rule:a};return{sheet:s,rule:s.insertRule(t+"{"+e+"}",o)}}},utils.deleteCssRule=function(t,e){if(t){try{t.deleteRule?t.deleteRule(e):t.removeRule&&t.removeRule(e)}catch(t){return!1}return!0}return!1},utils.createCssString=function(css){var styleString="";if(utils.isObject(css))for(var cssIndex in css)if(css.hasOwnProperty(cssIndex)){var style=css[cssIndex];if(utils.isObject(style)&&!1!==style.enabled)if(style.calc){var macros={};if(utils.isArray(style.value))for(var valueIndex in style.value)macros["value_"+valueIndex]=style.value[valueIndex];else macros={value:style.value};try{style=eval(utils.replaceMacros(style.calc,macros))}catch(t){style=utils.replaceMacros(style.calc,macros)}}else style=style.value;(utils.isString(style)||utils.isNumber(style))&&(-1!==cssIndex.indexOf("url")&&(style=utils.getAssetUrl(style)),styleString=styleString+(cssIndex+":")+(""===style?'""':style)+";")}return styleString},utils.createCssFontString=function(t){var e="";if(utils.isObject(t))for(var s in t)if(t.hasOwnProperty(s)){var i=t[s];if("src"===s){for(var r in i)if(i.hasOwnProperty(r)&&0<i[r].length){for(var a in e+="src: ",i[r])if(i[r].hasOwnProperty(a)){var n=i[r][a].url,l=i[r][a].format;n&&(e=e+'url("'+utils.getAssetUrl(n)+'")',l&&(e=e+' format("'+l+'")'),a<i[r].length-1&&(e+=","))}e+=";"}}else e="font-family"===s?e+s+':"'+i+'";':e+s+":"+i+";"}return e},utils.mergeObjects=function(e,s,t,i){for(var r in s)if(s.hasOwnProperty(r))try{t&&utils.isArray(s[r])?e[r]=utils.mergeArrays(e[r],s[r]):i&&utils.isArray(i)&&utils.arrayContains(i,r)?e[r]=s[r]:utils.isObject(s[r])?e[r]=utils.mergeObjects(e[r],s[r],t,i):e[r]=s[r]}catch(t){e[r]=s[r]}return e},utils.extractExceptions=function(t,e,s,i,r){e=utils.isArray(e)?e:[],r=utils.isString(r)?r:"excepts",i=utils.isNumber(i)?i:999,s=utils.isArray(s)?s:[];try{if(utils.isObject(t)){for(var a in t)if(a===r){for(var n in t[a])if(t[a].hasOwnProperty(n)&&utils.arrayContains(e,n)&&0<i&&!utils.arrayContains(s,a))if(utils.isObject(t[a][n]))if(utils.isObject(t[a][n].data))if(utils.isTypeOf(utils.isBoolean,t[a][n].enabled,!0))for(var l in t[a][n].data)t[a][n].data.hasOwnProperty(l)&&(t[a][n].replace||!t[l]||!utils.isObject(t[l])||utils.isArray(t[l])?t[a][l]=t[l]=utils.extractExceptions(t[a][n].data[l],e,s,i-1,r):t[a][l]=utils.mergeObjects(t[l],utils.extractExceptions(t[a][n].data[l],e,s,i-1,r),t[a][n].mergeArrays,t[a][n].replaceArrays));else delete t[a][n];else null!==t[a][n].data&&(t[a]=utils.mergeObjects(t,utils.extractExceptions(t[a][n],e,s,i-1,r)));else t[a]=t[a][n]}else utils.isObject(t[a])&&0<i&&!utils.arrayContains(s,a)&&(t[a]=utils.extractExceptions(t[a],e,s,i-1,r));t[r]&&delete t[r]}}catch(t){}return t},utils.wrapElement=function(t){var e=null,s=null;if(utils.isArray(t)&&0<t.length)for(var i=0;i<t.length;i++)if(!utils.isEmptyString(t[i])){var r=document.createElement(t[i]);utils.isElement(s)?(s.appendChild(r),s=r):utils.isElement(e)?(e.appendChild(r),s=r):e=s=r}return{initial:e,latest:s}},utils.replaceMacros=function(t,i,e,s,r,a){if(utils.isArray(i)){var n={};for(var l in i)n=utils.mergeObjects(n,utils.cloneObject(i[l]));i=n}function o(t,e){try{for(var s in i)t=t.toString().split(a[0]+s+a[1]).join(i[s]),e||("true"===t&&(t=!0),"false"===t&&(t=!1),"null"===t&&(t=null))}catch(t){}return t}e=utils.isArray(e)?e:[],s=!utils.isBoolean(s)||s,r=utils.isNumber(r)?r:999,a=utils.isArray(a)?a:["$[","]"];try{if(utils.isString(t))t=o(t);else if(utils.isObject(t))for(var u in t)if(t.hasOwnProperty(u))if(utils.isString(t[u])){t[u]=o(t[u]);for(var p,c=t[u],d=0;d<10&&(utils.isString(t[u])&&c!==p&&-1!==t[u].indexOf(a[0])&&-1!==t[u].indexOf(a[1]));d++)t[u]=o(t[u]),p=t[u]}else{var y;if(0<r&&!utils.arrayContains(e,u)&&(t[u]=utils.replaceMacros(t[u],i,e,s,r-1)),s)u&&-1!==u.indexOf(a[0])&&-1!==u.indexOf(a[1])&&(y=o(u,!0)),y&&y!==u&&(t[y]=utils.cloneObject(t[u]),delete t[u])}}catch(t){}return t},utils.setAttribute=function(t,e,s,i){if(t){var r=[""].concat(i||[]);for(var a in r)try{t.setAttribute(r[a]+e,s)}catch(t){}}},utils.removeAttribute=function(t,e,s){if(t){var i=[""].concat(s||[]);for(var r in i)try{t.removeAttribute(i[r]+e)}catch(t){}}},utils.CSVToArray=function(t,e){e=e||",";for(var s=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),i=[[]],r=null;r=s.exec(t);){var a,n=r[1];n.length&&n!==e&&i.push([]),a=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],i[i.length-1].push(a)}return i},utils.GestureListener=function(t,e,s){this.target=utils.isTypeOf(utils.isElement,t,t===document?document:null),this.callback=utils.isTypeOf(utils.isFunction,e,null),this.params={prevent:utils.isTypeOf(utils.isBoolean,utils.getObjectDeep(s,"prevent"),!0),delay:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(s,"delay"),0)},this.events={},this.startEvent=null;function i(t,e){n.callback(t,e,n.startEvent)}function r(t){i("click",t)}function a(t){if((t=t||window.event).changedTouches&&(t=t.changedTouches[0]),n.startEvent=t,n.events.mousemove=utils.addEventSimple(n.target,"mousemove",l),n.events.touchmove=utils.addEventSimple(n.target,"touchmove",l),n.events.mouseup=utils.addEventSimple(n.target,"mouseup",o),n.events.mouseout=utils.addEventSimple(n.target,"mouseout",o),n.events.touchend=utils.addEventSimple(n.target,"touchend",o),n.events.touchcancel=utils.addEventSimple(n.target,"touchcancel",o),n.events.click=utils.addEventSimple(n.target,"click",r),i("start",t),n.params.prevent)return!1}var n=this,l=function(t){if(n.events.click=utils.removeEventSimple(n.target,"click",r),i("move",t),n.params.prevent)return!1},o=function(t){if(n.events.mousemove=utils.removeEventSimple(n.target,"mousemove",l),n.events.touchmove=utils.removeEventSimple(n.target,"touchmove",l),n.events.mouseup=utils.removeEventSimple(n.target,"mouseup",o),n.events.mouseout=utils.removeEventSimple(n.target,"mouseout",o),n.events.touchend=utils.removeEventSimple(n.target,"touchend",o),n.events.touchcancel=utils.removeEventSimple(n.target,"touchcancel",o),i("stop",t),n.params.prevent)return!1};return n.target&&n.callback&&(n.events.mousedown=utils.addEventSimple(n.target,"mousedown",a),n.events.touchstart=utils.addEventSimple(n.target,"touchstart",a)),n};var props=tactic.builder.props;props.AbstractProp=function(){this.type="AbstractProp"},props.AbstractProp.prototype.set=function(t){this.data=utils.isTypeOf(utils.isObject,t,{}),this.enabled=utils.isTypeOf(utils.isBoolean,this.data.enabled,!0),this.name=utils.isTypeOf(utils.isString,this.data.name,this.name),this.value=this.data.value||void 0},props.AbstractProp.prototype.update=function(){return!0},props.DomainProp=function(t){this.type="DomainProp",this.name="domain",this.set(t)},props.DomainProp.prototype=new props.AbstractProp,props.DomainProp.prototype.constructor=props.DomainProp,props.DomainProp.prototype.update=function(t){return!(!this.enabled||!utils.isString(t))&&(this.value=utils.extractRootDomain(t),!0)},props.FontProp=function(t){this.type="FontProp",this.name="font",this.set(t),this.step=utils.isTypeOf(utils.isNumber,this.data.step,1),this.min=utils.isTypeOf(utils.isNumber,this.data.min,2),this.max=utils.isTypeOf(utils.isNumber,this.data.max,32)},props.FontProp.prototype=new props.AbstractProp,props.FontProp.prototype.constructor=props.FontProp,props.FontProp.prototype.update=function(e,s,i){var r=this;if(!r.enabled||!utils.isElement(e)||isNaN(s)||isNaN(i))return!1;var t=parseInt(utils.getStyle(e,"fontSize",NaN)),a=function(t){return t>r.min&&(e.offsetWidth>s||e.offsetHeight>i)&&(--t,e.style.fontSize=t+"px",t=a(t)),t};return e.style.visibility="hidden",r.value=a(isNaN(t)?r.max:t),e.style.fontSize="",!(e.style.visibility="")},props.ModeProp=function(t){this.type="ModeProp",this.name="mode",this.set(t),this.options=utils.isTypeOf(utils.isArray,this.data.options,["live","capture","debug"])},props.ModeProp.prototype=new props.AbstractProp,props.ModeProp.prototype.constructor=props.ModeProp,props.ModeProp.prototype.update=function(t){return!!(this.enabled&&utils.isString(t)&&utils.arrayContains(this.options,t))&&(this.value=t,!0)},props.NameProp=function(t){this.type="NameProp",this.name="name",this.set(t)},props.NameProp.prototype=new props.AbstractProp,props.NameProp.prototype.constructor=props.NameProp,props.NameProp.prototype.update=function(t){return!(!this.enabled||!utils.isString(t))&&(this.value=t,!0)},props.PositionProp=function(t){this.type="PositionProp",this.name="position",this.set(t),this.top=NaN,this.left=NaN,this.width=NaN,this.height=NaN,this.params=null},props.PositionProp.prototype=new props.AbstractProp,props.PositionProp.prototype.constructor=props.PositionProp,props.PositionProp.prototype.update=function(t,e,s,i,r){var a=this;if(!a.enabled||isNaN(t)||isNaN(e)||isNaN(s)||isNaN(i))return!1;a.params=utils.isTypeOf(utils.isObject,r,{}),a.params={align:utils.isTypeOf(utils.isArray,a.params.align,["center","middle"]),scale:utils.isTypeOf(utils.isString,a.params.scale,"fill"),crop:utils.isTypeOf(utils.isArray,a.params.crop,[0,0,0,0]),offset:utils.isTypeOf(utils.isArray,a.params.offset,[1,1])},a.params.offset[1]=1-t*(a.params.crop[1]+a.params.crop[3])/t,a.params.offset[0]=1-e*(a.params.crop[0]+a.params.crop[2])/e;var n=NaN,l=NaN,o=NaN,u=NaN;try{switch(i<=s?(l=s/t*e/a.params.offset[1],n=s/a.params.offset[1],"fill"===a.params.scale?i/a.params.offset[0]>l&&(n=i/e*t/a.params.offset[0],l=i/a.params.offset[0]):i/a.params.offset[0]<=l&&(n=i/e*t/a.params.offset[0],l=i/a.params.offset[0])):(n=i/e*t/a.params.offset[0],l=i/a.params.offset[0],"fill"===a.params.scale?s/a.params.offset[1]>n&&(l=s/t*e/a.params.offset[1],n=s/a.params.offset[1]):s/a.params.offset[1]<=n&&(l=s/t*e/a.params.offset[1],n=s/a.params.offset[1])),n=Math.ceil(n),l=Math.ceil(l),a.params.align[0]){case"left":o=0-n*a.params.crop[3];break;case"center":o=(s-n*a.params.offset[1])/2+(0-n*a.params.crop[3]);break;case"right":o=s-n+n*a.params.crop[1]}switch(o=Math.round(o),a.params.align[1]){case"top":u=0-l*a.params.crop[0];break;case"middle":u=(i-l*a.params.offset[0])/2+(0-l*a.params.crop[0]);break;case"bottom":u=i-l+l*a.params.crop[2]}u=Math.round(u)}catch(t){}return a.top=u,a.left=o,a.width=n,a.height=l,!0},props.ScaleProp=function(t){this.type="ScaleProp",this.name="scale",this.set(t),this.area={param:utils.isTypeOf(utils.isNumber,this.data.area,24e3),value:NaN},this.velocity={param:utils.isTypeOf(utils.isNumber,this.data.velocity,0),value:NaN},this.font={param:utils.isTypeOf(utils.isNumber,this.data.font,4),value:NaN},this.options=utils.isTypeOf(utils.isArray,this.data.options,[[0,"xs",0],[32e3,"s",0],[64e3,"m",0],[256e3,"l",0]])},props.ScaleProp.prototype=new props.AbstractProp,props.ScaleProp.prototype.constructor=props.ScaleProp,props.ScaleProp.prototype.update=function(t,e){var s=this;if(!s.enabled||isNaN(t)||isNaN(e))return!1;s.area.value=t*e,s.velocity.value=Math.sqrt(s.area.value/s.area.param),s.velocity.value=s.velocity.value+s.velocity.value*s.velocity.param/10,s.velocity.value=s.velocity.value<1?1:s.velocity.value,s.value=utils.selectProperty(s.options,s.area.value);var i=1;for(var r in s.options){var a=s.options[r];if(a[1]===s.value){i=utils.isTypeOf(utils.isNumber,1+a[2]/20,1);break}}return s.font.value=Math.round(s.font.param*s.velocity.value*i),!0},props.SizeProp=function(t){this.type="SizeProp",this.name="size",this.set(t),this.width=NaN,this.height=NaN},props.SizeProp.prototype=new props.AbstractProp,props.SizeProp.prototype.constructor=props.SizeProp,props.SizeProp.prototype.update=function(t,e){if(this.enabled){function s(t){return utils.isString(t)&&"%"===t.substr(t.length-1)&&(t=Number(t.substr(0,t.length-1))/100),t}if(t=s(t),e=s(e),!isNaN(t)&&!isNaN(e))return this.width=t,this.height=e,this.value=t+"x"+e,!0}return!1},props.TensionProp=function(t){this.type="TensionProp",this.name="tension",this.set(t),this.velocity={taller:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(this.data,"velocity.taller"),0),wider:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(this.data,"velocity.wider"),0),value:NaN},this.options=utils.isTypeOf(utils.isArray,this.data.options,[[0,"p"],[.714,"s"],[1.5,"l"]])},props.TensionProp.prototype=new props.AbstractProp,props.TensionProp.prototype.constructor=props.TensionProp,props.TensionProp.prototype.update=function(t,e){var s=this;return!(!s.enabled||isNaN(t)||isNaN(e))&&(s.velocity.value=((e<=t?t/e:e/t)-1)*(e<=t?s.velocity.wider:10*s.velocity.taller)/100,s.value=utils.selectProperty(s.options,t/e),!0)};var layers=tactic.builder.layers;layers.AbstractLayer=function(){this.type="AbstractLayer"},layers.AbstractLayer.prototype.set=function(t,e,s,i,r,a){r=utils.isTypeOf(utils.isObject,r,{}),this.timestamp=(new Date).getTime(),this.data=utils.isTypeOf(utils.isObject,utils.cloneObject(e),{}),this.callback=utils.isTypeOf(utils.isFunction,s,utils.noop),this.parent=utils.isTypeOf(utils.isObject,i,null),this.root=this.root?this.root:this.parent?this.parent.root:void 0,this.timeline=this.root.timeline?this.root.timeline:new utils.Timeline,this.registry=this.parent?this.parent.registry:{},this.sequence=this.sequence||(this.parent&&this.parent.sequence?this.parent.sequence:null),this.index=utils.isTypeOf(utils.isNumber,a,NaN),this.frame=NaN,this.parent&&("FrameLayer"===this.type?(this.frame=utils.isTypeOf(utils.isNumber,a,0),this.parent.frames.push(this)):(this.frame=this.parent.frame,this.parent.layers.push(this))),this.key=utils.isTypeOf(utils.isString,t,"UNDEFINED"),this.namespace=(this.parent&&this.parent.namespace?this.parent.namespace+".":"")+this.key,this.selector=(this.parent&&this.parent.selector?this.parent.selector+" ":"")+"[data-key="+this.key+"]",(this.registry[this.namespace]=this).target=r.target?r.target:this.getTarget(this.key),this.target||this.root!==this?!this.target&&this.data.create&&(this.target=document.createElement("div"),this.target.style.zIndex=utils.isTypeOf(utils.isNumber,this.data.index,""),this.target.setAttribute("data-key",this.key),this.parent&&this.parent.target?this.parent.target.appendChild(this.target):document.body.appendChild(this.target)):this.target=document.body,this.events={},this.gestures={},this.timers={},this.layers=[],this.logs=[],this.macros={local:{},global:{}},this.props={},this.params={},(this.holder=this).wrapper=this.holder,this.attrs={local:[],global:[],hidden:[],styles:{}},this.anims={},this.sources=[],this.feed={},this.custom={},this.width=function(){return utils.isTypeOf(utils.isNumber,r.width,this.target.offsetWidth)},this.height=function(){return utils.isTypeOf(utils.isNumber,r.height,this.target.offsetHeight)},this.inited=void 0,this.enabled=void 0,this.loaded=void 0,this.entered=void 0,this.hash=void 0},layers.AbstractLayer.prototype.init=function(){var t=this;if(t.inited||!t.target)return!1;var e=t.getAttrs(),s=t.getMacros(),i=utils.extractExceptions(utils.cloneObject(t.data),e,["fonts","macros","params","attrs","anims","sources","custom"]);return delete i.layers,delete i.frames,t.enabled=!t.parent||!!t.parent.enabled&&utils.isTypeOf(utils.isBoolean,i.enabled,!0),t.enabled?(t.trigger({type:"enabled"}),t.initMacros(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.macros,{}),s),e)),s=t.getMacros(),t.initProps(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.props,{}),s),e)),s=t.getMacros(),t.initAttrs(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.attrs,{}),s),e)),e=t.getAttrs(),t.initParams(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.params,{}),s),e)),t.initFeed(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.feed,{}),s),e)),t.initSources(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.sources,{}),s),e)),t.initCustom(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.custom,{}),s),e)),t.initHolder(t.params.holder),t.initWrapper(t.params.wrapper),t.initAnims(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.anims,{}),s),e))):t.trigger({type:"disabled"}),t.inited=!0,t.timers.init=t.timeline.setTimeout(function(){t.trigger({type:"init"})},0),!0},layers.AbstractLayer.prototype.initHolder=function(t,e){var s=this;return!s.inited&&(s.holder=utils.isTypeOf(utils.isObject,s.getLayer(s.params.holder,s.params.depth),s),!0)},layers.AbstractLayer.prototype.initWrapper=function(t,e){var s=this;return!s.inited&&(s.wrapper=utils.isTypeOf(utils.isObject,s.getLayer(s.params.wrapper,s.params.depth),s.holder?s.holder:s),!0)},layers.AbstractLayer.prototype.initMacros=function(t){return!this.inited&&this.addMacros(t)},layers.AbstractLayer.prototype.initProps=function(t){var e=this;if(e.inited)return!1;if(e.props={},t.size&&(e.props.size=new props.SizeProp(t.size),e.props.size.update(e.width(),e.height()),e.props.size.enabled)){var s=(utils.isEmptyString(e.props.size.name)?"":e.props.size.name+"_")+e.props.size.value;e.addAttr(e.props.size.name,{name:s,global:!0})}if(t.scale&&(e.props.scale=new props.ScaleProp(t.scale),e.props.scale.update(e.width(),e.height()),e.props.scale.enabled)){var i=(utils.isEmptyString(e.props.scale.name)?"":e.props.scale.name+"_")+e.props.scale.value;e.addAttr(e.props.scale.name,{name:i,global:!0}),0<e.props.scale.font.value&&e.addAttr(i+"_font",{css:{"font-size":e.props.scale.font.value+"px"}})}if(t.tension&&(e.props.tension=new props.TensionProp(t.tension),e.props.tension.update(e.width(),e.height()),e.props.tension.enabled)){var r=(utils.isEmptyString(e.props.tension.name)?"":e.props.tension.name+"_")+e.props.tension.value;e.addAttr(r,{name:r,global:!0})}return!0},layers.AbstractLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5)},!0)},layers.AbstractLayer.prototype.initAttrs=function(t){return!this.inited&&this.addAttrs(t)},layers.AbstractLayer.prototype.initAnims=function(t){return!this.inited&&this.addAnims(t)},layers.AbstractLayer.prototype.initSources=function(t){return!this.inited&&(utils.isArray(t)&&0<t.length?this.sources=t:this.sources=[],!0)},layers.AbstractLayer.prototype.initFeed=function(t){var e=this;if(e.inited)return!1;if(e.feed={enabled:utils.isTypeOf(utils.isBoolean,t.enabled,!1),id:utils.isTypeOf(utils.isNumber,t.id,0),index:utils.isTypeOf(utils.isNumber,Number(t.index),0),key:utils.isTypeOf(utils.isNumber,Number(t.key),NaN),name:utils.isTypeOf(utils.isString,t.name,null),splitter:utils.isTypeOf(utils.isString,t.splitter,null),value:void 0},e.feed.enabled){var s=e.root.feeds[e.feed.id];if(s&&s.data&&s.enabled){if(e.feed.name&&isNaN(e.feed.key)){var i=s.data.index.indexOf(e.feed.name);-1!==i&&(e.feed.key=i)}if(!isNaN(e.feed.key)){var r=s.data.items[e.feed.index][e.feed.key],a={value:r};e.feed.splitter&&r&&utils.each(r.split(e.feed.splitter),function(t,e){a["value_"+e]=t}),e.feed.value=t.value?utils.replaceMacros(t.value,a):r}}}return!0},layers.AbstractLayer.prototype.initCustom=function(t){return!this.inited&&(this.custom=t,!0)},layers.AbstractLayer.prototype.load=function(){return!(!this.inited||this.loaded)&&(this.loaded=!0,this.trigger({type:"load"}),!0)},layers.AbstractLayer.prototype.unload=function(){return this.inited&&this.loaded&&(this.loaded=!1,this.trigger({type:"unload"})),this.inited},layers.AbstractLayer.prototype.loadable=function(){return!(!this.inited||!this.enabled)&&(!this.sequence||this.sequence&&this.entered)},layers.AbstractLayer.prototype.destroy=function(){var i=this;return!!i.inited&&(utils.each(i.timers,function(t,e){i.timeline.clearTimeout(t),delete i.timers[e]}),utils.each(i.events,function(t,e){t&&(i.events[e]=utils.removeEventSimple(t.target,t.type,t.callback),delete i.events[e])}),utils.each(i.gestures,function(t,s){t&&(utils.each(t.events,function(t,e){t&&(i.gestures[s].events[e]=utils.removeEventSimple(t.target,t.type,t.callback))}),delete i.gestures[s])}),i.unload(),utils.removeClasses(i.target,i.attrs.local),i.attrs.local=[],utils.removeClasses(i.target,i.attrs.global),i.attrs.global=[],i.attrs.hidden=[],utils.each(i.attrs.styles,function(t,e){t&&(utils.deleteCssRule(t.sheet,t.rule),delete i.attrs.styles[e])}),i.params={},i.macros.local={},i.macros.global={},i.feed={},this.anims={},i.inited=!1,i.trigger({type:"destroy"}),i.custom={},!0)},layers.AbstractLayer.prototype.trigger=function(t){return this.logs.push([((new Date).getTime()-this.root.timestamp/1e3).toFixed(2),t.type,t.detail&&t.detail.key?t.detail.key:null]),this.callback(t)},layers.AbstractLayer.prototype.execute=function(e,t,s,i,r,a){var n=this;if(r=isNaN(r)?100:r,!t||i&&utils.arrayContains(i,n.key)||(utils.isFunction(e)?e.apply(n,s):utils.isFunction(n[e])&&n[e].apply(n,s)),0<r){function l(t){t.execute(e,!0,s,i,r-1)}for(var o in n.layers)l(n.layers[o]);if(n.frames)for(var u in n.frames)l(n.frames[u])}},layers.AbstractLayer.prototype.available=function(){var t=this;return!!(t.inited&&t.enabled&&t.loaded)&&(!t.sequence||!!t.entered)},layers.AbstractLayer.prototype.playable=function(){return!!this.available()&&(!this.root||!this.root.stopped)},layers.AbstractLayer.prototype.addMacro=function(key,macro){var that=this;if(utils.isEmptyString(key))return!1;if(utils.isString(macro)||utils.isNumber(macro)||utils.isBoolean(macro))that.macros.local[key]=macro;else{if(!utils.isObject(macro)||!1===macro.enabled)return!1;var type=!0===macro.global?"global":"local";if(utils.isEmptyString(macro.calc))that.macros[type][key]=macro.value;else try{that.macros[type][key]=eval(utils.replaceMacros(macro.calc,{value:macro.value}))}catch(t){}}return!0},layers.AbstractLayer.prototype.addMacros=function(t){var s=this;return!!utils.isObject(t)&&(utils.each(t,function(t,e){s.addMacro(e,t)}),!0)},layers.AbstractLayer.prototype.getMacros=function(s,i){var r={};return utils.each(this.macros,function(t,e){"local"===e&&s||utils.each(t,function(t,e){i&&!utils.isUndefined(i[e])||(r[e]=t)})}),this.parent&&(r=utils.mergeObjects(r,this.parent.getMacros(!0,r))),r},layers.AbstractLayer.prototype.addAttr=function(i,r){var a=this;if(utils.isEmptyString(i))return!1;if(r){if(!utils.isObject(r)||!1===r.enabled)return!1;var n=!0===r.global?"global":"local";r.macros&&(r.css=utils.replaceMacros(r.css,r.macros)),utils.each(utils.isArray(r.selector)?r.selector:[r.selector?r.selector:""],function(t){if(r.css){var e=r.name?r.name:i+(""===t?"":"_"+t.replace(/[^a-zA-Z0-9]/g,"_")),s=utils.createCssString(r.css);a.attrs.styles[e]&&a.removeAttrs(e),a.attrs.styles[e]=utils.createCssRule(a.selector+(r.name?" ."+r.name:"")+(":"===t.substr(0,1)?t:" "+t),s)}r.name?utils.arrayContains(a.attrs[n],r.name)||(a.attrs[n].push(r.name),utils.addClass(a.target,r.name)):utils.arrayContains(a.attrs.hidden,e)||a.attrs.hidden.push(e)})}else utils.arrayContains(a.attrs.local,i)||(a.attrs.local.push(i),utils.addClass(a.target,i));return!0},layers.AbstractLayer.prototype.addAttrs=function(t){var s=this;if(utils.isString(t)&&(t=[t]),utils.isArray(t))utils.each(t,function(t){s.addAttr(t)});else{if(!utils.isObject(t))return!1;utils.each(t,function(t,e){s.addAttr(e,t)})}return!0},layers.AbstractLayer.prototype.getAttrs=function(s){var i=[];return utils.each(this.attrs,function(t,e){"local"===e&&s||"styles"===e||utils.each(t,function(t){i=i.concat(t)})}),this.parent&&(i=i.concat(this.parent.getAttrs(!0))),i},layers.AbstractLayer.prototype.removeAttr=function(t){function e(t,e){for(var s in t)if(t.hasOwnProperty(s)&&t[s]===e){t.splice(s,1),i.attrs.styles[e]&&(utils.deleteCssRule(i.attrs.styles[e].sheet,i.attrs.styles[e].rule),delete i.attrs.styles[e]);break}}var i=this;return utils.isString(t)&&(e(i.attrs.local,t),e(i.attrs.global,t),e(i.attrs.hidden,t),utils.removeClass(i.target,t)),!1},layers.AbstractLayer.prototype.removeAttrs=function(t){var e=this;return!(!t||(utils.isString(t)&&(t=[t]),!utils.isArray(t)))&&(utils.each(t,function(t){e.removeAttr(t)}),!0)},layers.AbstractLayer.prototype.addAnim=function(t,e){var s=this;return!(utils.isEmptyString(t)||!utils.isObject(e)||!1===e.enabled||utils.isEmptyString(e.name)||s.anims[t])&&(s.anims[t]={name:e.name,apply:utils.isTypeOf(utils.isBoolean,e.apply,!0),target:"wrapper"===e.target||"holder"===e.target?s[e.target]:s,skip:utils.isTypeOf(utils.isBoolean,e.skip,!0)},s.anims[t].apply&&s.anims[t].target.addAttr(s.anims[t].name),!0)},layers.AbstractLayer.prototype.addAnims=function(t){var s=this;if(utils.isString(t)&&(t=[t]),utils.isArray(t)){var e=0;utils.each(t,function(t){e++,s.addAnim(e.toString(),t)})}else{if(!utils.isObject(t))return!1;utils.each(t,function(t,e){s.addAnim(e,t)})}return!0},layers.AbstractLayer.prototype.removeAnim=function(t){return!utils.isEmptyString(t)&&this.anims[t]&&(this.anims[t]=null),!0},layers.AbstractLayer.prototype.removeAnims=function(t){var s=this;if(utils.isString(t)&&(t=[t]),utils.isArray(t))utils.each(t,function(t){s.removeAnim(t)});else{if(!utils.isObject(t))return!1;utils.each(t,function(t,e){s.removeAnim(e)})}return!0},layers.AbstractLayer.prototype.getAnims=function(){return this.anims},layers.AbstractLayer.prototype.addLayer=function(t,e,s,i,r,a){return utils.isFunction(t)?new t(e,s,i,this,r,a):null},layers.AbstractLayer.prototype.getLayer=function(t,e){var s,i,r=this.layers;for(s in r)if((i=r[s]).key===t)return i;if(0<e)for(s in r){var a=(i=r[s]).getLayer(t,e-1);if(a)return a}else if(e<0&&this.parent)return this.parent.getLayer(t,e+1);return null},layers.AbstractLayer.prototype.getLayers=function(a){if(utils.isEmptyString(a))return[];var n=[];return this.registry[a]?n.push(this.registry[a]):utils.each(this.registry,function(t){if(t.key===a)n.push(t);else if(-1!==a.indexOf("#"))if(-1!==a.indexOf(".")){var e=a.split("."),s=t.namespace.split(".");if(s.length===e.length){for(var i=utils.cloneObject(s),r=0;r<e.length;r++)-1!==e[r].indexOf("#")&&(i[r]=i[r].replace(/[0-9]/g,"#"));utils.isEqualArray(e,i)&&n.push(t)}}else{utils.cloneObject(t.key).replace(/[0-9]/g,"#")===a&&n.push(t)}}),n},layers.AbstractLayer.prototype.getTarget=function(t){var e=utils.getElementsByKey(this.target,t)[0];return!e&&this.parent&&(e=utils.getElementsByKey(this.parent.target,t)[0]),e=e||utils.getElementsByKey(document.body,t)[0]},layers.BannerLayer=function(t,e,s,i){this.type="BannerLayer",this.root=this;try{var r=utils.getQsParam("bm_macros");if(!utils.isEmptyString(r)){var a=JSON.parse(decodeURIComponent(r)),n=JSON.stringify(e),l=new RegExp(Object.keys(a).join("|").replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"gi");n=n.replace(l,function(t){return a[t]}),e=JSON.parse(n)}}catch(t){}this.set(t,e,s,null,i),this.target.setAttribute("data-key",this.key),this.props={domain:null,vendor:null,name:null,size:null,mode:null},this.definition={},this.clicktag={},this.feeds={},this.fonts={},this.assets={},this.events={resize:null,interaction_mousedown:null,interaction_touchstart:null},this.mode=null,this.inanimate=!this.target||(!this.target.style||void 0===this.target.style.animation),this.enabled=!0,this.loaded=!1,this.stopped=void 0,this.captured=!1,this.entered=!0,this.interacted=!1,this.trigger({type:"set"})},layers.BannerLayer.prototype=new layers.AbstractLayer,layers.BannerLayer.prototype.constructor=layers.BannerLayer,layers.BannerLayer.prototype.init=function(){var t=this;if(t.inited)return!1;var e,s,i=utils.cloneObject(t.data);return t.initMode(/PhantomJS/i.test(navigator.userAgent)?"capture":i.mode),t.initMacros(utils.isTypeOf(utils.isObject,i.macros,{})),t.addMacro("package_url",{global:!0,value:tactic.url.package}),t.addMacro("speed",{global:!0,value:t.timeline.speed}),s=t.getMacros(),t.initProps(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.props,{}),s)),s=t.getMacros(),e=t.getAttrs(),t.initAttrs(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.attrs,{}),s),e)),e=t.getAttrs(),t.initParams(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.params,{}),s)),t.initDefinition(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.definition,{}),s),e)),t.initClicktag(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.clicktag,{}),s),e)),t.initFeeds(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.feeds,{}),s),e)),t.initFonts(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.fonts,{}),s),e.concat([t.props.vendor.value]))),t.initSources(),t.initCustom(utils.extractExceptions(utils.replaceMacros(utils.isTypeOf(utils.isObject,i.custom,{}),s),e)),t.build(i.layers,t),t.timers.stop=t.timeline.setTimeout(function(){t.stop()},t.params.stop.after),t.events.resize=utils.addEventSimple(window,"resize",function(){t.resize.apply(t)}),t.events.interaction_mousedown=utils.addEventSimple(t.target,"mousedown",function(){t.interact()}),t.events.interaction_touchstart=utils.addEventSimple(t.target,"touchstart",function(){t.interact()}),t.inited=!0,t.timers.init=t.timeline.setTimeout(function(){t.trigger({type:"init"})},0),!0},layers.BannerLayer.prototype.initMode=function(t){var e=this;return!e.inited&&(e.mode="capture"===t?t:0<container.ADVERT_ID?"live":utils.isTypeOf(utils.isString,t,"live"),e.addAttr(e.mode,{name:e.mode,global:!0}),!0)},layers.BannerLayer.prototype.initProps=function(t){var s=this;return!s.inited&&(t=utils.isTypeOf(utils.isObject,t,{}),s.props.domain=new props.DomainProp(t.domain),s.props.domain.update(container.HOST),s.props.vendor=new props.NameProp(utils.mergeObjects({name:"vendor"},t.vendor||{})),s.props.vendor.update(container.MEDIA),s.props.name=new props.NameProp(t.name),s.props.name.update(container.NAME),s.props.size=new props.SizeProp(t.size),s.props.size.update(container.WIDTH,container.HEIGHT),s.props.mode=new props.ModeProp(t.mode),s.props.mode.update(s.mode),utils.each(s.props,function(t,e){t.enabled&&s.addMacro(t.name,{global:!0,value:t.value})}),!0)},layers.BannerLayer.prototype.initDefinition=function(t){return!this.inited&&(this.definition=t,!0)},layers.BannerLayer.prototype.initClicktag=function(t){return!this.inited&&(this.clicktag={override:utils.isTypeOf(utils.isBoolean,t.override,!1),synchronise:utils.isTypeOf(utils.isBoolean,t.synchronise,!1),url:utils.isTypeOf(utils.isUrl,t.url,""),options:utils.isTypeOf(utils.isArray,t.options,[])},!0)},layers.BannerLayer.prototype.initFeeds=function(t){return!this.inited&&(this.feeds=t,!0)},layers.BannerLayer.prototype.initFonts=function(t){var a=this;return!a.inited&&(utils.each(t,function(s,e){if(s&&!utils.isEmptyString(s.url)&&!1!==s.enabled){s.name&&utils.isBoolean(s.name)&&(s.name=e),s.alt||(s.alt="sans-serif");var i={"font-family":e,"font-weight":utils.isTypeOf(utils.isString,s.weight,"normal"),"font-style":utils.isTypeOf(utils.isString,s.style,"normal"),"font-display":"swap",src:[[],[]]};utils.each(s.types,function(t,e){switch(t){case"eot":i.src[0].push({url:utils.getAssetUrl(s.url+"."+t)}),i.src[1].push({url:utils.getAssetUrl(s.url+"."+t+"#iefix"),format:"embedded-opentype"});break;default:i.src[1].push({url:utils.getAssetUrl(s.url+"."+t),format:t})}});var t=utils.createCssRule("@font-face",utils.createCssFontString(i));a.attrs.styles[e]=t,a.fonts[e]={loaded:!1,style:t},utils.isEmptyString(s.name)||a.addAttr(e,{selector:"."+s.name,css:{"font-family":'"'+e+'", "'+s.alt+'"'}}),utils.isArray(s.selector)&&utils.each(s.selector,function(t){utils.isEmptyString(t)||a.addAttr(e,{selector:t,css:{"font-family":'"'+e+'", "'+s.alt+'"'}})})}else{var r=utils.arrayIndex(a.params.wait.fonts,e);-1<r&&a.params.wait.fonts.splice(r,1)}}),!0)},layers.BannerLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5),wait:{fonts:utils.isTypeOf(utils.isArray,utils.getObjectDeep(t,"wait.fonts"),[]),assets:utils.isTypeOf(utils.isArray,utils.getObjectDeep(t,"wait.assets"),[]),feeds:utils.isTypeOf(utils.isArray,utils.getObjectDeep(t,"wait.feeds"),[]),timeout:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"wait.timeout"),5e3)},stop:{after:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"stop.after"),3e4)},capture:{delay:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"capture.delay"),3e3)},resize:{delay:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"resize.delay"),500)}},!0)},layers.BannerLayer.prototype.initSources=function(t){var r=this;if(r.inited)return!1;var e=[].slice.call(r.target.getElementsByTagName("img")).concat([].slice.call(r.target.getElementsByTagName("video")));return utils.each(e,function(t){if(t){var e=t.getAttribute("data-key"),s=t.getAttribute("data-source");if(utils.isEmptyString(e)||utils.isEmptyString(s)||t.src){var i=utils.arrayIndex(r.params.wait.assets,e);-1<i&&r.params.wait.assets.splice(i,1)}else r.assets[e]={target:t,source:s,polite:"true"===t.getAttribute("data-polite")},"true"===t.getAttribute("data-wait")&&utils.arrayIndex(r.params.wait.assets,e)<0&&r.params.wait.assets.push(e)}}),!0},layers.BannerLayer.prototype.build=function(t,a){var n=this;return!n.inited&&(utils.each(t,function(t,e){var s=utils.isTypeOf(utils.isFunction,t?layers[utils.isString(t.type)?t.type.split("Component").join("Layer"):null]:null,null),i=utils.isNumber(e)?a.key+"_"+e:e,r=n.trigger({type:"build",detail:{Constructor:s,key:i,index:Number(e),data:t,parent:a}});!r&&s&&(r=a.addLayer(s,i,t,n.callback,null,Number(e))),r&&t&&(t.layers&&n.build(t.layers,r),t.frames&&n.build(t.frames,r))}),!0)},layers.BannerLayer.prototype.load=function(){var i=this;if(i.loaded)return!1;function r(t){i.loaded||(t&&t.count++,(e||a.count>=a.list.length&&l.count>=l.list.length&&n.count>=n.list.length)&&(i.timeline.clearTimeout(i.timers.load),i.loaded=!0,i.trigger({type:"load"})))}function s(t){var e=this;e.src&&-1!==e.src.indexOf(".svg")?e.src=e.src.replace(/.svg$/,".png"):(utils.removeEventSimple(e,"error",o),r(n))}var e=!1,a={list:i.params.wait.fonts,count:0},n={list:i.params.wait.assets,count:0},l={list:i.params.wait.feeds,count:0},o=function(t){utils.removeEventSimple(this,"load",o),r(n)};return utils.each(i.feeds,function(t,s){if(t){i.feeds[s].key=s;var e=utils.getAssetUrl(t.source);t.enabled&&utils.isUrl(e)&&(l.list.push(e),utils.get(-1!==e.indexOf("127.0.0.1")?e:e+"&r="+Math.round(999999999*Math.random()),function(t){try{if("csv"===i.feeds[s].type){var e=utils.CSVToArray(t.responseText);i.feeds[s].data={meta:{},index:e[0],items:e},i.feeds[s].data.items.shift()}else i.feeds[s].data=JSON.parse(t.responseText).data;i.feeds[s].loaded=!0}catch(t){i.feeds[s].loaded=!1}r(l)},function(t){i.feeds[s].loaded=!0,r(l)}))}}),utils.each(a.list,function(t){utils.isEmptyString(t)?r(a):utils.watchFont(t,t,function(t,e){i.fonts[t]&&(i.fonts[t].loaded=e),r(a)})}),utils.each(i.assets,function(t,e){t.target&&(0<=utils.arrayIndex(i.params.wait.assets,e)&&(utils.addEventSimple(t.target,"error",s),utils.addEventSimple(t.target,"load",o)),t.polite&&!container.isPoliteReady()?container.one(container.EVT_ADAPTER_POLITE,function(){t.target.src=utils.getAssetUrl(t.source)}):t.target.src=utils.getAssetUrl(t.source))}),r(),i.timers.load=i.timeline.setTimeout(function(){e=!0,r()},i.params.wait.timeout),!0},layers.BannerLayer.prototype.capture=function(){var t=this;return!(!t.inited||t.captured)&&(t.timeline.clearTimeout(t.timers.capture),t.timers.capture=t.timeline.setTimeout(function(){t.timers.capture=t.timeline.setTimeout(function(){t.captured=!0,window.TACTIC_CAPTURE=!0},t.params.capture.delay),t.trigger({type:"capture"})},0),!0)},layers.BannerLayer.prototype.stop=function(){var t=this;return!!t.inited&&(t.timeline.clearTimeout(t.timers.stop),t.timers.stop=t.timeline.setTimeout(function(){t.stopped=!0,t.trigger({type:"stop"})},0),!0)},layers.BannerLayer.prototype.destroy=function(){return!1},layers.BannerLayer.prototype.resize=function(){var t=this;return!!t.inited&&(t.timeline.clearTimeout(t.timers.resize),t.timers.resize=t.timeline.setTimeout(function(){t.trigger({type:"resize"})},t.params.resize.delay),!0)},layers.BannerLayer.prototype.interact=function(){var t=this;t.inited&&(utils.removeEventSimple(t.target,"mouseover",t.events.interaction_mousedown.callback),utils.removeEventSimple(t.target,"touchstart",t.events.interaction_touchstart.callback),t.interacted=!0,t.trigger({type:"interaction"}))},layers.BannerLayer.prototype.getClickTag=function(t){var e=this;return{url:e.clicktag.override?e.clicktag.options[t]&&utils.isUrl(e.clicktag.options[t].url)?e.clicktag.options[t].url:e.clicktag.url:"",vars:e.clicktag.synchronise?e.definition:{}}},layers.FrameLayer=function(t,e,s,i,r,a){this.type="FrameLayer",this.set(t,e,s,i,r,a),this.trigger({type:"set"})},layers.FrameLayer.prototype=new layers.AbstractLayer,layers.FrameLayer.prototype.constructor=layers.FrameLayer,layers.FrameLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5),duration:utils.isTypeOf(utils.isNumber,t.duration,0)},!0)},layers.FrameLayer.prototype.initMacros=function(t){return!this.inited&&(this.addMacro("index",{value:this.index,global:!0}),this.addMacros(t))},layers.ImageLayer=function(t,e,s,i,r,a){this.type="ImageLayer",this.set(t,e,s,i,r,a),this.props={position:null},this.asset={target:null,key:this.key+"_ASSET",tags:null,source:null},this.trigger({type:"set"})},layers.ImageLayer.prototype=new layers.AbstractLayer,layers.ImageLayer.prototype.constructor=layers.ImageLayer,layers.ImageLayer.prototype.initProps=function(t){layers.AbstractLayer.prototype.initProps.apply(this,[t]);return!this.inited&&(this.props.position=new props.PositionProp(t.position),!0)},layers.ImageLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5),tags:utils.isTypeOf(utils.isArray,t.tags,[]),polite:utils.isTypeOf(utils.isBoolean,t.polite,!1),align:utils.isTypeOf(utils.isArray,t.align,["center","middle"]),crop:utils.isTypeOf(utils.isArray,t.crop,[0,0,0,0]),scale:utils.isTypeOf(utils.isString,t.scale,"fill"),ratio:Number(utils.isTypeOf(utils.isNumber,t.ratio,1)),limit:{min:Number(utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"limit.min"),320)),max:Number(utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"limit.max"),1920))}},this.params.ratio<1&&(this.params.ratio=1),!0)},layers.ImageLayer.prototype.initSources=function(t){var e=this;return!e.inited&&(e.feed.enabled?e.sources=[{url:e.feed.value}]:utils.isArray(t)&&0<t.length?e.sources=t:e.sources=[],!0)},layers.ImageLayer.prototype.load=function(){var i=this;if(!i.inited||!i.enabled||i.loaded||i.asset.target)return!1;if(0<i.sources.length){function t(){i.asset.target.src=utils.getAssetUrl(i.asset.source)}function e(){i.addAttr(i.props.position.name,{selector:'[data-key="'+i.asset.key+'"]',css:{position:"absolute",left:i.props.position.left+"px",top:i.props.position.top+"px",width:i.props.position.width+"px",height:i.props.position.height+"px"}})}var s=function(t){i.events.load=utils.removeEventSimple(i.asset.target,"load",s),i.props.position.enabled&&(isNaN(i.props.position.width)||isNaN(i.props.position.height))&&(i.props.position.update(i.asset.target.width,i.asset.target.height,i.width(),i.height(),i.params),e()),i.loaded=!0,i.trigger({type:"load"})},r=function(t){var e=i.asset.target;if(e){utils.removeEventSimple(e,"error",r);var s=e.src;s&&-1!==s.indexOf(".svg")&&(e.src=s.replace(/.svg$/,".png"))}};i.asset.target=document.createElement("img"),i.asset.tags=utils.wrapElement(i.params.tags),i.asset.target.setAttribute("data-key",i.asset.key),i.asset.tags=utils.wrapElement(i.params.tags),i.asset.tags&&utils.isElement(i.asset.tags.initial)&&utils.isElement(i.asset.tags.latest)?(i.target.appendChild(i.asset.tags.initial),i.asset.tags.latest.appendChild(i.asset.target)):i.target.appendChild(i.asset.target),i.events.load=utils.addEventSimple(i.asset.target,"load",s),i.events.error=utils.addEventSimple(i.asset.target,"error",r),i.props.position.update(i.sources[0].width,i.sources[0].height,i.width(),i.height(),i.params),i.props.position.enabled?(i.asset.source=utils.getAssetSource(i.sources,i.props.position.width*i.params.ratio,i.props.position.height*i.params.ratio,i.params.limit.min,i.params.limit.max),isNaN(i.props.position.width)||isNaN(i.props.position.height)||e()):i.asset.source=utils.getAssetSource(i.sources,i.width()*i.params.ratio,i.height()*i.params.ratio,i.params.limit.min,i.params.limit.max),!0!==i.params.polite||container.isPoliteReady()?t():container.one(container.EVT_ADAPTER_POLITE,function(){t()})}else i.trigger({type:"empty"});return!0},layers.ImageLayer.prototype.unload=function(){var t=this;return t.inited&&t.loaded&&(t.asset.tags&&t.asset.tags.initial?t.target.removeChild(t.asset.tags.initial):t.asset.target&&t.target.removeChild(t.asset.target),t.asset.tags=null,t.asset.source=null,t.asset.target=null,t.loaded=!1,t.trigger({type:"unload"})),!1},layers.JointLayer=function(t,e,s,i,r,a){this.type="JointLayer",this.set(t,e,s,i,r,a),this.trigger({type:"set"})},layers.JointLayer.prototype=new layers.AbstractLayer,layers.JointLayer.prototype.constructor=layers.JointLayer,layers.SequenceLayer=function(t,e,s,i,r,a){this.type="SequenceLayer",(this.sequence=this).frames=[],this.set(t,e,s,i,r,a),this.previous=null,this.current=null,this.next=null,this.history=[],this.state=NaN,this.direction=NaN,this.loops=0,this.changes=0,this.looped=!1,this.repeated=!1,this.paused=void 0,this.stopped=!1,this.trigger({type:"set"})},layers.SequenceLayer.prototype=new layers.AbstractLayer,layers.SequenceLayer.prototype.constructor=layers.SequenceLayer,layers.SequenceLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5),play:{from:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"play.from"),0)},pause:{after:{time:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"pause.after.time"),NaN),frame:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"pause.after.frame"),NaN),loop:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"pause.after.loop"),NaN)}},stop:{on:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"stop.on"),NaN)},load:{before:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"load.before"),0),after:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"load.after"),1)},direction:utils.isTypeOf(utils.isNumber,t.direction,1)},!0)},layers.SequenceLayer.prototype.available=function(){var t=this;return!(!t.inited||!t.enabled)&&(t.sequence===t||!t.sequence||!!t.entered)},layers.SequenceLayer.prototype.play=function(){var t=this;return!(!t.inited||!t.enabled)&&(utils.isUndefined(t.paused)&&!t.stopped?(t.timeline.clearTimeout(t.timers.change),isNaN(t.params.pause.after.time)||(t.timers.pause=t.timeline.setTimeout(function(){t.pause()},t.params.pause.after.time)),t.paused=!1,t.trigger({type:"play"}),t.change(t.params.play.from)):(t.paused=!1,t.change(t.state)),!0)},layers.SequenceLayer.prototype.pause=function(){var t=this;return!(!t.inited||!t.enabled)&&(t.timeline.clearTimeout(t.timers.change),t.timeline.clearTimeout(t.timers.pause),!1===t.paused&&(t.paused=!0,isNaN(t.state)||t.trigger({type:"pause"})),!0)},layers.SequenceLayer.prototype.stop=function(t){var e=this;return!(!e.inited||!e.enabled)&&(e.timeline.clearTimeout(e.timers.stop),e.timeline.clearTimeout(e.timers.change),e.timeline.clearTimeout(e.timers.pause),e.stopped=!0,e.trigger({type:"stop"}),isNaN(e.params.stop.on)||t||e.change(e.params.stop.on),!0)},layers.SequenceLayer.prototype.toggle=function(){var t=this;return t.inited&&t.enabled?(t.paused?t.play():t.pause(),t.trigger({type:"toggle"}),t.state):NaN},layers.SequenceLayer.prototype.change=function(t){var e=this;if(e.inited&&e.enabled){function s(t){return isNaN(t)&&(t=isNaN(e.state)?0:e.state),(t<0||t>=e.frames.length)&&(t=0<=e.direction?t<0?e.frames.length-1:0:0<t?0:e.frames.length-1),t}return e.timeline.clearTimeout(e.timers.change),e.looped=!1,e.repeated=!1,isNaN(e.direction)&&(e.direction=e.params.direction),t=s(t),e.state!==t?(e.state=t,e.changes++):e.repeated=!0,e.history.push(e.state),1<e.frames.length&&(e.current&&e.current!==e.frames[e.state]?e.previous=e.current:e.previous&&(e.previous=e.frames[s(e.state-e.direction)]),e.next=e.frames[s(e.state+e.direction)]),e.current=e.frames[e.state],!1===e.paused&&!0!==e.stopped&&e.current&&e.current.inited&&1<e.frames.length&&0<e.current.params.duration&&(e.timers.change=e.timeline.setTimeout(function(){!isNaN(e.params.pause.after.loop)&&e.loops>=e.params.pause.after.loop||!isNaN(e.params.pause.after.frame)&&e.changes>=e.params.pause.after.frame?e.pause():e.change(e.state+e.direction)},e.current.params.duration)),e.changes/e.frames.length-1>=e.loops&&(e.loops++,e.looped=!0),e.current&&e.current.execute(function(){this.entered=!0,this.trigger({type:"enter"})},!0),e.previous&&e.previous.execute(function(){this.trigger({type:"leave"}),this.entered=!1},!0),e.trigger({type:"change"}),e.state}return NaN},layers.SequenceLayer.prototype.changeNext=function(){var t=this;return t.inited&&t.enabled?(t.trigger({type:"next"}),t.change(t.state+t.direction)):NaN},layers.SequenceLayer.prototype.changePrevious=function(){var t=this;return t.inited&&t.enabled?(t.trigger({type:"previous"}),t.change(t.state-t.direction)):NaN},layers.SequenceLayer.prototype.reverse=function(){var t=this;return t.inited&&t.enabled?(t.direction=-t.direction,t.trigger({type:"reverse"}),t.direction):NaN},layers.SequenceLayer.prototype.load=function(){var t=this;if(t.inited&&t.enabled){var e=[],s=0;t.state-t.params.load.before<0&&(s=t.params.load.before-t.state);var i=0;for(var r in t.state+t.params.load.after>t.frames.length-1&&(i=t.params.load.after+t.state-(t.frames.length-1)),t.frames){var a=!1;r>=t.state-t.params.load.before&&r<=t.state+t.params.load.after||r>=t.frames.length-s?a=!0:r<=i-1&&(a=!0),a&&t.frames[r].execute("load",!0),e.push(a)}return t.loaded=!0,t.timers.load=t.timeline.setTimeout(function(){t.trigger({type:"load",detail:{list:e}})},0),!0}return!1},layers.TextLayer=function(t,e,s,i,r,a){this.type="TextLayer",this.set(t,e,s,i,r,a),this.props={font:null},this.asset={target:null,key:this.key+"_ASSET",tags:null,source:null},this.trigger({type:"set"})},layers.TextLayer.prototype=new layers.AbstractLayer,layers.TextLayer.prototype.constructor=layers.TextLayer,layers.TextLayer.prototype.initProps=function(t){layers.AbstractLayer.prototype.initProps.apply(this,[t]);return!this.inited&&(this.props.font=new props.FontProp(utils.isTypeOf(utils.isObject,t.font,{})),!0)},layers.TextLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5),tags:utils.isTypeOf(utils.isArray,t.tags,[]),line:{before:utils.isTypeOf(utils.isString,utils.getObjectDeep(t,"line.before"),""),after:utils.isTypeOf(utils.isString,utils.getObjectDeep(t,"line.after"),"<br/>")},wait:{fonts:utils.isTypeOf(utils.isBoolean,utils.getObjectDeep(t,"wait.fonts"),!0),timeout:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"wait.timeout"),1e3)}},!0)},layers.TextLayer.prototype.initSources=function(t){var e=this;if(e.inited)return!1;if(e.feed.enabled)e.sources=[{text:utils.isTypeOf(utils.isString,e.feed.value,"")}];else if(utils.isArray(t)&&0<t.length){for(var s=t.length-1;0<=s;s--)isNaN(t[s].text)||(t[s].text+=""),utils.isEmptyString(t[s].text)&&t.splice(s,1);e.sources=t,e.sources.sort(function(t,e){return t.length<e.length?1:t.length>e.length?-1:0})}else e.sources=[];return!0},layers.TextLayer.prototype.load=function(){var e=this;if(!e.inited||!e.enabled||e.loaded||e.asset.target)return!1;if(0<e.sources.length){e.asset.target=document.createElement("span"),e.asset.tags=utils.wrapElement(e.params.tags),e.asset.target.setAttribute("data-key",e.asset.key),e.asset.tags&&utils.isElement(e.asset.tags.initial)&&utils.isElement(e.asset.tags.latest)?(e.target.appendChild(e.asset.tags.initial),e.asset.tags.latest.appendChild(e.asset.target)):e.target.appendChild(e.asset.target);function s(){e.timers.load=e.timeline.setTimeout(function(){for(var t=0;t<e.sources.length&&(e.asset.source=e.sources[t],e.asset.target.innerHTML=e.params.line.before+e.asset.source.text.split(/\r\n|\n|\r/).join(e.params.line.after+e.params.line.before).split("  ").join(" &nbsp;")+e.params.line.after,!(e.holder.width()<=e.wrapper.width()&&e.holder.height()<=e.wrapper.height()));t++);e.props.font.update(e.holder.target,e.wrapper.width(),e.wrapper.height()),e.props.font.enabled&&e.holder.addAttr(e.props.font.name,{css:{"font-size":e.props.font.value+"px"}}),e.loaded=!0,e.trigger({type:"load"})},0)}e.params.wait.fonts?utils.watchFont(e.selector,null,function(t,e){s()},e.target,e.params.wait.timeout):s()}else e.trigger({type:"empty"});return!0},layers.TextLayer.prototype.unload=function(){var t=this;return!(!t.inited||!t.asset)&&(t.asset.tags&&t.asset.tags.initial?t.target.removeChild(t.asset.tags.initial):t.asset.target&&t.target.removeChild(t.asset.target),t.asset.tags=null,t.asset.source=null,t.asset.target=null,t.loaded=!1,t.trigger({type:"unload"}),!0)},layers.VideoLayer=function(t,e,s,i,r,a){this.type="VideoLayer",this.set(t,e,s,i,r,a),this.props={position:null},this.asset={target:null,key:this.key+"_ASSET",tags:null,source:null,resume:null},this.trigger({type:"set"})},layers.VideoLayer.prototype=new layers.AbstractLayer,layers.VideoLayer.prototype.constructor=layers.VideoLayer,layers.VideoLayer.prototype.initProps=function(t){return!this.inited&&(this.props.position=new props.PositionProp(utils.isTypeOf(utils.isObject,t.position,{})),!0)},layers.VideoLayer.prototype.initParams=function(t){return!this.inited&&(this.params={holder:utils.isTypeOf(utils.isString,t.holder,null),wrapper:utils.isTypeOf(utils.isString,t.wrapper,null),depth:utils.isTypeOf(utils.isNumber,t.depth,-5),tags:utils.isTypeOf(utils.isArray,t.tags,[]),polite:utils.isTypeOf(utils.isBoolean,t.polite,!0),align:utils.isTypeOf(utils.isArray,t.align,["center","middle"]),crop:utils.isTypeOf(utils.isArray,t.crop,[0,0,0,0]),scale:utils.isTypeOf(utils.isString,t.scale,"fill"),ratio:Number(utils.isTypeOf(utils.isNumber,t.ratio,1)),limit:{min:Number(utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"limit.min"),320)),max:Number(utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"limit.max"),1920))},autoplay:utils.isTypeOf(utils.isBoolean,t.autoplay,!1),controls:utils.isTypeOf(utils.isBoolean,t.controls,!1),fullscreen:utils.isTypeOf(utils.isBoolean,t.fullscreen,!1),start:{from:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"start.from"),NaN)},stop:{on:utils.isTypeOf(utils.isNumber,utils.getObjectDeep(t,"stop.on"),NaN)},loop:utils.isTypeOf(utils.isBoolean,t.loop,!0),muted:utils.isTypeOf(utils.isBoolean,t.muted,!0),poster:utils.isTypeOf(utils.isString,t.poster,null),preload:utils.isTypeOf(utils.isString,t.preload,"metadata"),inline:utils.isTypeOf(utils.isBoolean,t.inline,!0),volume:utils.isTypeOf(utils.isNumber,t.volume,.8)},this.params.ratio<1&&(this.params.ratio=1),!0)},layers.VideoLayer.prototype.initSources=function(t){var e=this;return!e.inited&&(e.feed.enabled?e.sources=[{url:e.feed.value}]:utils.isArray(t)&&0<t.length?e.sources=t:e.sources=[],!0)},layers.VideoLayer.prototype.load=function(){var e=this;if(!e.inited||!e.enabled||e.loaded||e.asset.target)return!1;if(0<e.sources.length){function t(){e.inited&&("thumb"===e.params.poster?e.asset.target.poster=utils.getAssetUrl(e.asset.source,"thumb_url"):"preview"===e.params.poster?e.asset.target.poster=utils.getAssetUrl(e.asset.source,"preview_url"):utils.isUrl(e.params.poster)&&(e.asset.target.poster=e.params.poster),e.asset.target.src=utils.getAssetUrl(e.asset.source))}function s(t){if(e.params.fullscreen)e.trigger(t);else try{return t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),!1}catch(t){}}var i=function(t){e.events.load=utils.removeEventSimple(e.asset.target,"loadedmetadata",i),e.loaded=!0,e.available()&&(e.asset.resume?e.asset.target.currentTime=e.asset.resume.time:isNaN(e.params.start.from)||(e.asset.target.currentTime=e.params.start.from),(e.asset.resume&&!1===e.asset.resume.paused||!e.asset.resume&&e.params.autoplay)&&e.play()),e.trigger({type:"load"}),e.asset.target.paused&&e.trigger({type:"pause"}),e.asset.resume=null};e.asset.target=document.createElement("video"),e.asset.tags=utils.wrapElement(e.params.tags),e.asset.target.setAttribute("data-key",e.asset.key),e.asset.tags=utils.wrapElement(e.params.tags),e.asset.tags&&utils.isElement(e.asset.tags.initial)&&utils.isElement(e.asset.tags.latest)?(e.target.appendChild(e.asset.tags.initial),e.asset.tags.latest.appendChild(e.asset.target)):e.target.appendChild(e.asset.target),e.asset.target.preload=e.params.preload,e.asset.target.controls=e.params.controls,e.asset.target.playsinline=e.params.inline,e.params.inline?utils.setAttribute(e.asset.target,"playsinline","true",["webkit-"]):utils.removeAttribute(e.asset.target,"playsinline",["webkit-"]),e.params.inline?utils.setAttribute(e.asset.target,"video-available-inline","",["webkit-"]):utils.removeAttribute(e.asset.target,"video-available-inline",["webkit-"]),e.asset.target.autoplay=!1,e.asset.target.muted=e.asset.resume?e.asset.resume.muted:e.params.muted,e.asset.target.allowfullscreen=e.params.fullscreen,e.asset.target.loop=e.params.loop,e.asset.target.volume=e.asset.resume?e.asset.resume.volume:e.params.volume,e.events.fullscreen=utils.addEventSimple(e.asset.target,"fullscreenchange",s),e.events.fullscreenWebkit=utils.addEventSimple(e.asset.target,"webkitfullscreenchange",s),e.events.fullscreenMoz=utils.addEventSimple(e.asset.target,"mozfullscreenchange",s),e.events.play=utils.addEventSimple(e.asset.target,"play",function(t){e.trigger(t)}),e.events.pause=utils.addEventSimple(e.asset.target,"pause",function(t){e.trigger(t)}),e.events.seeked=utils.addEventSimple(e.asset.target,"seeked",function(t){t.detail={time:e.asset.target.currentTime},e.trigger(t)}),e.events.volume=utils.addEventSimple(e.asset.target,"volumechange",function(t){t.detail={volume:e.asset.target.volume},e.trigger(t),e.asset.target.muted?e.trigger({type:"mute"}):e.asset.target.muted||e.trigger({type:"unmute"})}),e.events.load=utils.addEventSimple(e.asset.target,"loadedmetadata",i),e.props.position.update(e.sources[0].width,e.sources[0].height,e.width(),e.height(),e.params),e.props.position.enabled?(e.asset.source=utils.getAssetSource(e.sources,e.props.position.width*e.params.ratio,e.props.position.height*e.params.ratio,e.params.limit.min,e.params.limit.max),e.addAttr(e.props.position.name,{selector:'[data-key="'+e.asset.key+'"]',css:{position:"absolute",left:e.props.position.left+"px",top:e.props.position.top+"px",width:e.props.position.width+"px",height:e.props.position.height+"px"}})):e.asset.source=utils.getAssetSource(e.sources,e.width()*e.params.ratio,e.height()*e.params.ratio,e.params.limit.min,e.params.limit.max),!0!==e.params.polite||container.isPoliteReady()?t():container.one(container.EVT_ADAPTER_POLITE,function(){t()})}else e.trigger({type:"empty"});return!0},layers.VideoLayer.prototype.unload=function(){var t=this;return t.inited&&t.asset&&(t.loaded&&t.asset.target&&(t.asset.resume={time:t.asset.target.currentTime,paused:t.asset.target.paused,muted:t.asset.target.muted,volume:t.asset.target.volume},t.asset.target.src=""),t.asset.tags&&t.asset.tags.initial?t.target.removeChild(t.asset.tags.initial):t.asset.target&&t.target.removeChild(t.asset.target),t.asset.tags=null,t.asset.source=null,t.asset.target=null,t.loaded=!1,t.trigger({type:"unload"})),!1},layers.VideoLayer.prototype.playable=function(){return!!this.available()&&(!this.asset.resume&&(!this.root||!this.root.stopped))},layers.VideoLayer.prototype.play=function(){var t=this;return!(!t.loaded||!t.asset.target.paused)&&(t.root.stopped?t.stop():t.asset.target.play(),!0)},layers.VideoLayer.prototype.pause=function(){return!(!this.loaded||this.asset.target.paused)&&(this.asset.target.pause(),!0)},layers.VideoLayer.prototype.togglePlay=function(){return!!this.loaded&&(this.asset.target.paused?this.asset.target.play():this.asset.target.pause())},layers.VideoLayer.prototype.stop=function(t){var e=this;return!!e.loaded&&(e.pause(),isNaN(e.params.stop.on)||t||(-1===e.params.stop.on?e.seek(e.asset.target.duration):e.seek(e.params.stop.on)),e.trigger({type:"stop"}),!0)},layers.VideoLayer.prototype.seek=function(t){return!!this.loaded&&(this.asset.target.currentTime=t,!0)},layers.VideoLayer.prototype.mute=function(){return!!this.loaded&&(this.asset.target.muted=!0)},layers.VideoLayer.prototype.unmute=function(){return!!this.loaded&&!(this.asset.target.muted=!1)},layers.VideoLayer.prototype.volume=function(t){return!!this.loaded&&(this.asset.target.volume=t,!0)},layers.VideoLayer.prototype.toggleMute=function(){return!!this.loaded&&(this.asset.target.muted?this.unmute():this.mute())}}(tactic);